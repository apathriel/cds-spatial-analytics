library(knitr)
library(rmdformats)
library(tidyverse)
library(sf)
library(mapboxapi)
## Global options
options(max.print="75")
opts_chunk$set(echo=TRUE,
cache=TRUE,
prompt=FALSE,
tidy=TRUE,
comment=NA,
message=FALSE,
warning=FALSE)
opts_knit$set(width=75)
no_cars <- df("../data/no_cars.csv", header = FALSE)
no_cars <- data.frame("../data/no_cars.csv", header = FALSE)
View(no_cars)
no_cars <- read_csv("../data/no_cars.csv", header = FALSE)
no_cars <- read_sf("../data/no_cars.csv", header = FALSE)
View(no_cars)
View(no_cars)
?colnames
names[:3] <- c("municipality","nc2020", "nc2021")
names[2:4] <- c("municipality","nc2020", "nc2021")
no_cars[2:4] <- c("municipality","nc2020", "nc2021")
class(no_cards)
class(no_cars)
colnames(no_cars) <- c("field_01","municipality","nc2020", "nc2021")
?names
?names
# Load tidyverse
library(tidyverse)
# load household data
hh <- read.csv2("../data/households2020_2021.csv", header = FALSE, fileEncoding=windows_1252)
# load household data
hh <- read.csv2("../data/households2020_2021.csv", header = FALSE, fileEncoding="windows_1252")
# load household data
hh <- read.csv2("../data/households2020_2021.csv", header = FALSE, fileEncoding="windows_1252")
# load household data
hh <- read.csv("../data/households2020_2021.csv", header = FALSE, fileEncoding="windows_1252")
2
# load household data
hh <- read.csv2("../data/households2020_2021.csv", header = FALSE, fileEncoding="windows_1252")
?read.csv2
# load household data
hh <- read.csv2("../data/households2020_2021.csv", header = FALSE, fileEncoding="windows_1252")
no_cars <- read.csv("../data/no_cars.csv", header = FALSE)
# load household data
hh <- read.csv2("../data/households2020_2021.csv", header = FALSE, fileEncoding="windows_1252")
# load household data
hh <- read.csv("../data/households2020_2021.csv", header = FALSE, fileEncoding="windows_1252")
# Load tidyverse
library(tidyverse)
# load household data
hh <- read.csv("../data/households2020_2021.csv", header = FALSE, fileEncoding="windows_1252")
??getData
# load household data
hh <- read.csv("../data/households2020_2021.csv", header = FALSE, fileEncoding="windows_1252")
# load household data
hh <- read.csv2("../data/households2020_2021.csv", header = FALSE, fileEncoding="windows_1252")
library(knitr)
library(rmdformats)
library(tidyverse)
library(sf)
library(mapboxapi)
## Global options
options(max.print="75")
opts_chunk$set(echo=TRUE,
cache=TRUE,
prompt=FALSE,
tidy=TRUE,
comment=NA,
message=FALSE,
warning=FALSE)
opts_knit$set(width=75)
# load household data
hh <- read.csv2("../data/households2020_2021.csv", header = FALSE, fileEncoding="windows_1252")
library(knitr)
library(rmdformats)
library(tidyverse)
library(sf)
library(mapboxapi)
## Global options
options(max.print="75")
opts_chunk$set(echo=TRUE,
cache=TRUE,
prompt=FALSE,
tidy=TRUE,
comment=NA,
message=FALSE,
warning=FALSE)
opts_knit$set(width=75)
no_cars <- read.csv("../data/no_cars.csv", header = FALSE)
colnames(no_cars) <- c("field_01","municipality","nc2020", "nc2021")
View(no_cars)
# Load tidyverse
library(tidyverse)
# load household data
hh <- read.csv2("households2020_2021.csv", header = FALSE, fileEncoding="windows_1252")
getwd()
# load household data
hh <- read.csv2("households2020_2021.csv", header = FALSE, fileEncoding="windows_1252")
# load household data
hh <- read.csv2("households2020_2021.csv", header = TRUE, fileEncoding="windows_1252")
FALSE
# load household data
hh <- read.csv2("households2020_2021.csv", header = FALSE, fileEncoding=windows_1252)
# load household data
hh <- read.csv2("households2020_2021.csv", header = FALSE, fileEncoding="windows-1252")
View(hh)
View(hh)
# create a summary of households per municipality
hh_mun <- hh %>%
group_by(V2) %>%
summarize(sum=sum(sum)) %>%
rename(municipality = V2, households = sum)
# create a summary of households per municipality
hh_mun <- hh %>%
group_by(V2) %>%
summarize(sum=sum(total)) %>%
rename(municipality = V2, households = sum)
?sum
?sum
# create a summary of households per municipality
hh_mun <- hh %>%
group_by(V2) %>%
summarize(sum=sum()) %>%
rename(municipality = V2, households = sum)
View(hh_mun)
# create a summary of households per municipality
hh_mun <- hh %>%
group_by(V2) %>%
summarize(sum=sum(V2)) %>%
rename(municipality = V2, households = sum)
View(hh_mun)
# create a summary of households per municipality
hh_mun <- hh %>%
group_by(V2) %>%
summarize(sum=sum()) %>%
rename(municipality = V2, households = sum)
View(hh_mun)
?sum
View(hh)
# create a summary of households per municipality
hh_mun <- hh %>%
group_by(V2) %>%
summarize(sum=sum(V4)) %>%
rename(municipality = V2, households = sum)
View(hh_mun)
View(no_cars)
# check total households
sum(hh_mun$households)
# join households to no_car dataset and calculate percentages
hh_nocar <- hh_mun %>% inner_join(no_cars, by = "municipality")
View(hh_nocar)
?mutate
View(hh_nocar)
View(hh_nocar)
hh_nocar <- hh_nocar %>%
mutate(nc2020pct = nc2020/households*100,
nc2021pct = nc2021/households*100)
View(no_cars)
View(hh_nocar)
# load municipalities
municipalities <-  getData("GADM", country = "DNK", level = 2)
library(raster)
# load municipalities
municipalities <-  getData("GADM", country = "DNK", level = 2)
View(municipalities)
# reconcile municipalities' and hh_nocars' problematic names
munic <- municipalities %>%
mutate(NAME_2 = gsub("Å", "Aa", NAME_2)) %>%
mutate(NAME_2 = gsub("ø", "oe", NAME_2)) %>%
mutate(NAME_2 = gsub("æ", "ae", NAME_2)) %>%
mutate(NAME_2 = gsub(" ", "", NAME_2)) %>%
mutate(NAME_2 = tolower(NAME_2))
# reconcile municipalities' and hh_nocars' problematic names
municipalities_4326 <- st_as_sf(municipalities, crs = 4326)
View(municipalities_4326)
munic <- municipalities %>%
mutate(NAME_2 = gsub("Å", "Aa", NAME_2)) %>%
mutate(NAME_2 = gsub("ø", "oe", NAME_2)) %>%
mutate(NAME_2 = gsub("æ", "ae", NAME_2)) %>%
mutate(NAME_2 = gsub(" ", "", NAME_2)) %>%
mutate(NAME_2 = tolower(NAME_2))
munic <- municipalities_4326 %>%
mutate(NAME_2 = gsub("Å", "Aa", NAME_2)) %>%
mutate(NAME_2 = gsub("ø", "oe", NAME_2)) %>%
mutate(NAME_2 = gsub("æ", "ae", NAME_2)) %>%
mutate(NAME_2 = gsub(" ", "", NAME_2)) %>%
mutate(NAME_2 = tolower(NAME_2))
View(munic)
View(municipalities_4326)
View(munic)
View(no_cars)
View(hh_nocar)
View(munic)
View(hh_nocar)
View(municipalities_4326)
munic <- municipalities_4326 %>%
mutate(NAME_2 = gsub("Å", "Aa", NAME_2)) %>%
mutate(NAME_2 = gsub("å", "aa", NAME_2)) %>%
mutate(NAME_2 = gsub(" ", "", NAME_2))
munic
View(munic)
no_cars_pct_mun  <-  munic %>% dplyr::inner_join(hh_nocar, by = c("NAME_2"="municipality")) # this preserves the spatial dimension!
View(no_cars_pct_mun)
View(munic)
# see if your join worked
library(mapview)
library(leaflet)
no_cars_pct_mun %>%
# dplyr::filter(nc2021pct >= 25) %>%
mapview(zcol = "nc2021pct")
View(hh)
View(hh_mun)
View(hh_mun)
View(no_cars)
no_cars <- read.csv("../data/no_cars.csv", header = FALSE, fileEncoding="windows-1252"))
no_cars <- read.csv("../data/no_cars.csv", header = FALSE, fileEncoding="windows-1252")
View(no_cars)
colnames(no_cars) <- c("field_01","municipality","nc2020", "nc2021")
# Load tidyverse
library(tidyverse)
# load household data
hh <- read.csv2("households2020_2021.csv", header = FALSE, fileEncoding="windows-1252")
# create a summary of households per municipality
hh_mun <- hh %>%
group_by(V2) %>%
summarize(sum=sum(V4)) %>%
rename(municipality = V2, households = sum)
# check total households
sum(hh_mun$households)
# join households to no_car dataset and calculate percentages
hh_nocar <- hh_mun %>% inner_join(no_cars, by = "municipality")
hh_nocar <- hh_nocar %>%
mutate(nc2020pct = nc2020/households*100,
nc2021pct = nc2021/households*100)
View(hh_mun)
View(hh_nocar)
# load municipalities
municipalities <-  getData("GADM", country = "DNK", level = 2)
# reconcile municipalities' and hh_nocars' problematic names
municipalities_4326 <- st_as_sf(municipalities, crs = 4326)
# reconcile municipalities' and hh_nocars' problematic names
municipalities_4326 <- st_as_sf(municipalities, crs = 4326)
munic <- municipalities_4326 %>%
mutate(NAME_2 = gsub("Å", "Aa", NAME_2)) %>%
mutate(NAME_2 = gsub("å", "aa", NAME_2)) %>%
mutate(NAME_2 = gsub(" ", "", NAME_2))
no_cars_pct_mun  <-  munic %>% dplyr::inner_join(hh_nocar, by = c("NAME_2"="municipality")) # this preserves the spatial dimension!
# see if your join worked
library(mapview)
library(leaflet)
no_cars_pct_mun %>%
# dplyr::filter(nc2021pct >= 25) %>%
mapview(zcol = "nc2021pct")
View(hh_mun)
View(hh_mun)
View(hh)
View(hh_mun)
View(munic)
View(municipalities_4326)
View(no_cars)
View(no_cars_pct_mun)
View(hh_nocar)
View(hh_mun)
View(hh)
regions <- municipalities <-  getData("GADM", country = "DNK", level = 1)
regions_4326 <- st_as_sf(regions, crs = 4326)
View(regions_4326)
View(regions_4326)
View(regions_4326)
regions_central-jylland <- regions_4326 %>%
filter(NAME_1 == "Midtjylland")
regions_4326 <- st_as_sf(regions, crs = 4326)
regions_central <- regions_4326 %>%
filter(NAME_1 == "Midtjylland")
View(regions_central)
?st_difference
st_intersection(regions_central, no_cars_pct_mun) %>%
mapview(zcol = "nc2021pct")
st_intersection(regions_central, no_cars_pct_mun)
regions_central
View(regions_central)
regions_geo <- regions_central %>%
st_geometry()
View(regions_geo)
?st_intersec
?st_intersection
?st_intersect
?st_intersect
?st_intersection
plot(i, add = TRUE, lty = 2, col = "red")
i <- st_intersection(regions_central, no_cars_pct_mun)
View(i)
i %>%
# dplyr::filter(nc2021pct >= 25) %>%
mapview(zcol = "nc2021pct")
plot(i)
plot(st_geometry(i))
mapview(i)
i <- st_intersection(no_cars_pct_mun, regions_central)
mapview(i)
View(regions_central)
i <- st_intersects(no_cars_pct_mun, regions_central)
i
View(i)
View(i)
plot(i)
i <- st_intersection(no_cars_pct_mun, regions_central)
plot(i)
plot(i$name_2))
plot(i$NAME_2))
plot(i$NAME_2)
View(i)
plot(i)
plot(i$NAME_2)
plot(i)
View(i)
class(i)
st_crs(no_car_pct_midt)
st_crs(no_car_pct_midt)
st_crs(no_cars_pct_midt)
st_crs(no_cars_pct_mun)
